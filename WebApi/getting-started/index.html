<!doctype html><html lang="en" class="no-js"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="lang:clipboard.copy" content="Copy to clipboard"><meta name="lang:clipboard.copied" content="Copied to clipboard"><meta name="lang:search.language" content="en"><meta name="lang:search.pipeline.stopwords" content="True"><meta name="lang:search.pipeline.trimmer" content="True"><meta name="lang:search.result.none" content="No matching documents"><meta name="lang:search.result.one" content="1 matching document"><meta name="lang:search.result.other" content="# matching documents"><meta name="lang:search.tokenizer" content="[\s\-]+"><link rel="shortcut icon" href="../../assets/images/favicon.png"><meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.3.1"><title>Getting started - FlubuCore</title><link rel="stylesheet" href="../../assets/stylesheets/application.4031d38b.css"><link rel="stylesheet" href="../../assets/stylesheets/application-palette.224b79ff.css"><meta name="theme-color" content="#3f51b5"><script src="../../assets/javascripts/modernizr.74668098.js"></script><link href="https://fonts.gstatic.com" rel="preconnect" crossorigin><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono&display=swap"><style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style><link rel="stylesheet" href="../../assets/fonts/material-icons.css"></head><body dir="ltr" data-md-color-primary="indigo" data-md-color-accent="indigo"><svg class="md-svg"><defs><svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg></defs></svg> <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off"> <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off"> <label class="md-overlay" data-md-component="overlay" for="__drawer"></label><a href="#about" tabindex="1" class="md-skip">Skip to content </a><header class="md-header" data-md-component="header"><nav class="md-header-nav md-grid"><div class="md-flex"><div class="md-flex__cell md-flex__cell--shrink"><a href="../.." title="FlubuCore" class="md-header-nav__button md-logo"><i class="md-icon"></i></a></div><div class="md-flex__cell md-flex__cell--shrink"><label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label></div><div class="md-flex__cell md-flex__cell--stretch"><div class="md-flex__ellipsis md-header-nav__title" data-md-component="title"><span class="md-header-nav__topic">FlubuCore</span><span class="md-header-nav__topic">Getting started</span></div></div><div class="md-flex__cell md-flex__cell--shrink"><label class="md-icon md-icon--search md-header-nav__button" for="__search"></label><div class="md-search" data-md-component="search" role="dialog"><label class="md-search__overlay" for="__search"></label><div class="md-search__inner" role="search"><form class="md-search__form" name="search"><input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active"> <label class="md-icon md-search__icon" for="__search"></label> <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">&#xE5CD;</button></form><div class="md-search__output"><div class="md-search__scrollwrap" data-md-scrollfix><div class="md-search-result" data-md-component="result"><div class="md-search-result__meta">Type to start searching</div><ol class="md-search-result__list"></ol></div></div></div></div></div></div><div class="md-flex__cell md-flex__cell--shrink"><div class="md-header-nav__source"><a href="https://github.com/dotnetcore/FlubuCore/" title="Go to repository" class="md-source" data-md-source="github"><div class="md-source__icon"><svg viewBox="0 0 24 24" width="24" height="24"><use xlink:href="#__github" width="24" height="24"></use></svg></div><div class="md-source__repository">GitHub</div></a></div></div></div></nav></header><div class="md-container"><nav class="md-tabs md-tabs--active" data-md-component="tabs"><div class="md-tabs__inner md-grid"><ul class="md-tabs__list"><li class="md-tabs__item"><a href="../.." title="FlubuCore" class="md-tabs__link">FlubuCore</a></li><li class="md-tabs__item"><a href="./" title="Web api" class="md-tabs__link md-tabs__link--active">Web api</a></li><li class="md-tabs__item"><a href="../../AwesomePlugins/awesome-plugins/" title="Awesome plugins" class="md-tabs__link">Awesome plugins</a></li><li class="md-tabs__item"><a href="https://github.com/dotnetcore/FlubuCore.Examples/wiki" title="Examples" class="md-tabs__link">Examples</a></li></ul></div></nav><main class="md-main"><div class="md-main__inner md-grid" data-md-component="container"><div class="md-sidebar md-sidebar--primary" data-md-component="navigation"><div class="md-sidebar__scrollwrap"><div class="md-sidebar__inner"><nav class="md-nav md-nav--primary" data-md-level="0"><label class="md-nav__title md-nav__title--site" for="__drawer"><a href="../.." title="FlubuCore" class="md-nav__button md-logo"><i class="md-icon"></i></a>FlubuCore</label><div class="md-nav__source"><a href="https://github.com/dotnetcore/FlubuCore/" title="Go to repository" class="md-source" data-md-source="github"><div class="md-source__icon"><svg viewBox="0 0 24 24" width="24" height="24"><use xlink:href="#__github" width="24" height="24"></use></svg></div><div class="md-source__repository">GitHub</div></a></div><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../.." title="FlubuCore" class="md-nav__link">FlubuCore</a></li><li class="md-nav__item"><a href="../../getting-started/" title="Getting started" class="md-nav__link">Getting started</a></li><li class="md-nav__item"><a href="../../buildscript-fundamentals/" title="Build script fundamentals" class="md-nav__link">Build script fundamentals</a></li><li class="md-nav__item"><a href="../../build-script-runner/" title="Build script runner" class="md-nav__link">Build script runner</a></li><li class="md-nav__item"><a href="../../tasks/" title="Tasks" class="md-nav__link">Tasks</a></li><li class="md-nav__item"><a href="../../write-plugins/" title="How to write and use plugins" class="md-nav__link">How to write and use plugins</a></li><li class="md-nav__item"><a href="../../Tests-debugging/" title="Tests and debuging" class="md-nav__link">Tests and debuging</a></li><li class="md-nav__item md-nav__item--active md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-8" type="checkbox" id="nav-8" checked><label class="md-nav__link" for="nav-8">Web api</label><nav class="md-nav" data-md-component="collapsible" data-md-level="1"><label class="md-nav__title" for="nav-8">Web api</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item md-nav__item--active"><input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc"><label class="md-nav__link md-nav__link--active" for="__toc">Getting started</label><a href="./" title="Getting started" class="md-nav__link md-nav__link--active">Getting started</a><nav class="md-nav md-nav--secondary"><label class="md-nav__title" for="__toc">Table of contents</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="#about" title="About" class="md-nav__link">About</a><nav class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a href="#requirements" title="Requirements" class="md-nav__link">Requirements</a></li><li class="md-nav__item"><a href="#web-api-deployment" title="Web api deployment" class="md-nav__link">Web api deployment</a><nav class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a href="#iis-deployment" title="IIS deployment" class="md-nav__link">IIS deployment</a></li></ul></nav></li><li class="md-nav__item"><a href="#write-deploy-script" title="Write deploy script" class="md-nav__link">Write deploy script</a></li><li class="md-nav__item"><a href="#write-build-script" title="Write build script" class="md-nav__link">Write build script</a></li><li class="md-nav__item"><a href="#run-deploy-script" title="Run deploy script" class="md-nav__link">Run deploy script</a></li><li class="md-nav__item"><a href="#security" title="Security" class="md-nav__link">Security</a></li><li class="md-nav__item"><a href="#automatic-update" title="Automatic update" class="md-nav__link">Automatic update</a></li><li class="md-nav__item"><a href="#manual-target-execution-remotely-through-flubucore-web-app" title="Manual target execution remotely through FlubuCore web app" class="md-nav__link">Manual target execution remotely through FlubuCore web app</a></li></ul></nav></li></ul></nav></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-9" type="checkbox" id="nav-9"><label class="md-nav__link" for="nav-9">Awesome plugins</label><nav class="md-nav" data-md-component="collapsible" data-md-level="1"><label class="md-nav__title" for="nav-9">Awesome plugins</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../../AwesomePlugins/awesome-plugins/" title="Plugins" class="md-nav__link">Plugins</a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-10" type="checkbox" id="nav-10"><label class="md-nav__link" for="nav-10">Examples</label><nav class="md-nav" data-md-component="collapsible" data-md-level="1"><label class="md-nav__title" for="nav-10">Examples</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="https://github.com/dotnetcore/FlubuCore.Examples/wiki" title="Index" class="md-nav__link">Index</a></li></ul></nav></li></ul></nav></div></div></div><div class="md-sidebar md-sidebar--secondary" data-md-component="toc"><div class="md-sidebar__scrollwrap"><div class="md-sidebar__inner"><nav class="md-nav md-nav--secondary"><label class="md-nav__title" for="__toc">Table of contents</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="#about" title="About" class="md-nav__link">About</a><nav class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a href="#requirements" title="Requirements" class="md-nav__link">Requirements</a></li><li class="md-nav__item"><a href="#web-api-deployment" title="Web api deployment" class="md-nav__link">Web api deployment</a><nav class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a href="#iis-deployment" title="IIS deployment" class="md-nav__link">IIS deployment</a></li></ul></nav></li><li class="md-nav__item"><a href="#write-deploy-script" title="Write deploy script" class="md-nav__link">Write deploy script</a></li><li class="md-nav__item"><a href="#write-build-script" title="Write build script" class="md-nav__link">Write build script</a></li><li class="md-nav__item"><a href="#run-deploy-script" title="Run deploy script" class="md-nav__link">Run deploy script</a></li><li class="md-nav__item"><a href="#security" title="Security" class="md-nav__link">Security</a></li><li class="md-nav__item"><a href="#automatic-update" title="Automatic update" class="md-nav__link">Automatic update</a></li><li class="md-nav__item"><a href="#manual-target-execution-remotely-through-flubucore-web-app" title="Manual target execution remotely through FlubuCore web app" class="md-nav__link">Manual target execution remotely through FlubuCore web app</a></li></ul></nav></li></ul></nav></div></div></div><div class="md-content"><article class="md-content__inner md-typeset"><a href="https://github.com/dotnetcore/FlubuCore/edit/master/docs/WebApi/getting-started.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a><h1>Getting started</h1><h2 id="about"><strong>About</strong><a class="headerlink" href="#about" title="Permanent link">&para;</a></h2>
<p>With FlubuCore web api you can execute FlubuCore scripts remotely. Mainly it is meant to automate deployment of .net or .net core applications from your build server to different environments but it can be used for any other FlubuCore script execution.</p>
<p>Web Api supports:</p>
<ul>
<li>Executing flubu scripts on the server where web api is deployed.</li>
<li>Uploading (deploy or any other) packages to the server where web api is deployed.</li>
<li>Deleting packages from server where web api is deployed.</li>
<li>Sending reports back to client.</li>
<li>Uploading FlubuCore scripts to the server where web api is deployed.</li>
<li>Automatic updates</li>
<li>Manual target execution through FlubuCore web app(deployed together with web api)</li>
</ul>
<p>In this getting started tutorial we will:
- Deploy FlubuCore web api to the server.
- Write .net deployment script that will deploy mvc example application on the sever. You should go through this tutorial even if you want to use FlubuCore.WebApi for .net core application deployment. There are few small differences between using FlubuCore.WebApi for deploying .net core applications and .net applications. All differences are written in this tutorial.
- Write build script that will upload deployment package of the example application to the server and execute deployment script that we wrote.
- Run deployment script through build script remotely.</p>
<p><a name="requirements"></a></p>
<h3 id="requirements"><strong>Requirements</strong><a class="headerlink" href="#requirements" title="Permanent link">&para;</a></h3>
<ul>
<li>.net 462+ runtime or .net core runtime installed on the server. Depending on which build of FlubuCore.WebApi you plan to use.</li>
</ul>
<p><a name="Web-api-deployment"></a></p>
<h3 id="web-api-deployment"><strong>Web api deployment</strong><a class="headerlink" href="#web-api-deployment" title="Permanent link">&para;</a></h3>
<ul>
<li>Get appropriate web api deploy package from <a href="https://github.com/flubu-core/flubu.core/releases">https://github.com/flubu-core/flubu.core/releases</a>.</li>
<li>Copy web api deployment package to the server where you want to execute flubu script.</li>
<li>Unzip the package.</li>
<li>Set web api deployment configuration settings in the unzipped DeploymentConfig.json file. More about specific deployment config settings can be found in the configuration file.</li>
<li>On windows server run deploy.bat to deploy the web api</li>
<li>On linux/mac server run: dotnet restore and after that: dotnet flubu -s=deploymentscript.cs</li>
<li>On deployed location run dotnet FlubuCore.WebApi.dll to selfhost web api. You can of course also host it for example on iis...</li>
</ul>
<h4 id="iis-deployment">IIS deployment<a class="headerlink" href="#iis-deployment" title="Permanent link">&para;</a></h4>
<p>How to deploy asp .net core application see: <a href="https://docs.microsoft.com/en-us/aspnet/core/publishing/iis?tabs=aspnetcore2x">https://docs.microsoft.com/en-us/aspnet/core/publishing/iis?tabs=aspnetcore2x</a></p>
<p>Some actions might need administration rights like starting / stoping the application pool. If that's the case u have to change identity on the application pool where you hosted the web api. Go to Application pools -&gt; Web api app pool -&gt; Advanced settings -&gt; process model -&gt; Identity and change to user which has admin rights.</p>
<p><a name="Write-deploy-script"></a></p>
<h3 id="write-deploy-script"><strong>Write deploy script</strong><a class="headerlink" href="#write-deploy-script" title="Permanent link">&para;</a></h3>
<p>Example .net  deploy script can be found <a href="https://github.com/flubu-core/examples/blob/master/DeployScriptExample/BuildScript/DeployScript.cs">Here</a>. If u want to try the example the best way is to just clone the flubu core examples directory. Deploy script for .net core application would be of course slightly different.</p>
<p>Example deploy script for .net application will
 - Create iis application pool if it doesnt exists
 - Stop the application pool
 - Unzip package from /packages directory(which will be uploaded to web api with build script)
 - Copy unziped application to new folder where it is/will be hosted.
 - Create web site on iis for example web application
 - Start the application pool</p>
<p>When you finish writing your deploy script. manually copy it to web api deployed location /scripts folder. Web api can also upload scripts but it is disabled by default for obvious security reason. It should stay disabled in most cases.</p>
<p>If needed modify Example DeployScript for your needs.</p>
<p><a name="Write-build-script"></a></p>
<h3 id="write-build-script"><strong>Write build script</strong><a class="headerlink" href="#write-build-script" title="Permanent link">&para;</a></h3>
<p>Example .net build script can be found <a href="https://github.com/flubu-core/examples/blob/master/DeployScriptExample/BuildScript/BuildScript.cs">here</a></p>
<p>Example .net build script will
 - Get the authentication token
 - Delete old packages from /packages folder on web api.
 - Upload package to web api /packages folder
 - Execute Deployment script in /scripts folder that we manually uploaded</p>
<p>If needed modify Example BuildScript for your needs.</p>
<p><a name="Run-deploy-script"></a></p>
<h3 id="run-deploy-script"><strong>Run deploy script</strong><a class="headerlink" href="#run-deploy-script" title="Permanent link">&para;</a></h3>
<p>If u cloned example repository just execute at the root foolder:</p>
<p><code class="codehilite"><span class="n">dotnet</span> <span class="n">restore</span> <span class="n">buildscript</span><span class="p">.</span><span class="n">csproj</span></code> and <code class="codehilite"><span class="n">dotnet</span> <span class="n">flubu</span> <span class="n">deploy</span> <span class="o">-</span><span class="n">s</span><span class="o">=</span><span class="n">buildscript</span><span class="err">\</span><span class="n">buildscript</span><span class="p">.</span><span class="n">cs</span></code> in cmd from DeployScriptExample folder</p>
<p>In real case scenario you would probably deploy from your build server after sucesfull build, after merge to release branch, manually execute the job on build server...  </p>
<p><a name="Security"></a></p>
<h3 id="security"><strong>Security</strong><a class="headerlink" href="#security" title="Permanent link">&para;</a></h3>
<p>As attacker can do alot of damage if he gains access to web api next security measures should be implemented if possible:</p>
<ul>
<li>If possible Flubu web api should not be publicly accessible.</li>
<li>Always host web api on https.</li>
<li>Restrict access by ip(config).</li>
<li>Restrict access by time frame(config). This security measure should be taken if you deploy your application always at same time e.g 11pm. Then time frame when api can be accessed should be set for example from 11pm to 11.15pm,</li>
<li>Use very strong password(web api user creation).</li>
<li>Do not disable feature "Restrict access on failed login"(config).</li>
<li>Enable email notifications when GetToken/Script is executed on api(config).</li>
</ul>
<p>For detailed description of security settings see appsettings.json file on web api.</p>
<p><a name="Automatic-update"></a></p>
<h3 id="automatic-update"><strong>Automatic update</strong><a class="headerlink" href="#automatic-update" title="Permanent link">&para;</a></h3>
<p>You can automatically update FlubuCore web api if new version is available. Just navigate to /UpdateCenter (not /api/UpdateCenter)</p>
<p><a name="manual-target-execution"></a></p>
<h3 id="manual-target-execution-remotely-through-flubucore-web-app"><strong>Manual target execution remotely through FlubuCore web app</strong><a class="headerlink" href="#manual-target-execution-remotely-through-flubucore-web-app" title="Permanent link">&para;</a></h3>
<p>You can manually execute target through FlubuCore web app. Just navigate to /Script</p></article></div></div></main><footer class="md-footer"><div class="md-footer-nav"><nav class="md-footer-nav__inner md-grid"><a href="../../Tests-debugging/" title="Tests and debuging" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev"><div class="md-flex__cell md-flex__cell--shrink"><i class="md-icon md-icon--arrow-back md-footer-nav__button"></i></div><div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span class="md-flex__ellipsis"><span class="md-footer-nav__direction">Previous</span>Tests and debuging</span></div></a><a href="../../AwesomePlugins/awesome-plugins/" title="Plugins" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next"><div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span class="md-flex__ellipsis"><span class="md-footer-nav__direction">Next</span>Plugins</span></div><div class="md-flex__cell md-flex__cell--shrink"><i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i></div></a></nav></div><div class="md-footer-meta md-typeset"><div class="md-footer-meta__inner md-grid"><div class="md-footer-copyright">powered by <a href="https://www.mkdocs.org">MkDocs</a> and <a href="https://squidfunk.github.io/mkdocs-material/">Material for MkDocs</a></div></div></div></footer></div><script src="../../assets/javascripts/application.b260a35d.js"></script><script>app.initialize({version:"1.0.4",url:{base:"../.."}})</script></body></html>