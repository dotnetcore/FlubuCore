<!doctype html><html lang="en" class="no-js"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta http-equiv="x-ua-compatible" content="ie=edge"><link rel="canonical" href="http://flubucore.dotnetcore.xyz/buildscript-fundamentals/"><meta name="lang:clipboard.copy" content="Copy to clipboard"><meta name="lang:clipboard.copied" content="Copied to clipboard"><meta name="lang:search.language" content="en"><meta name="lang:search.pipeline.stopwords" content="True"><meta name="lang:search.pipeline.trimmer" content="True"><meta name="lang:search.result.none" content="No matching documents"><meta name="lang:search.result.one" content="1 matching document"><meta name="lang:search.result.other" content="# matching documents"><meta name="lang:search.tokenizer" content="[\s\-]+"><link rel="shortcut icon" href="../assets/images/favicon.png"><meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.3.1"><title>Build script fundamentals - FlubuCore</title><link rel="stylesheet" href="../assets/stylesheets/application.4031d38b.css"><link rel="stylesheet" href="../assets/stylesheets/application-palette.224b79ff.css"><meta name="theme-color" content="#3f51b5"><script src="../assets/javascripts/modernizr.74668098.js"></script><link href="https://fonts.gstatic.com" rel="preconnect" crossorigin><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|&display=swap"><style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"","Courier New",Courier,monospace}</style><link rel="stylesheet" href="../assets/fonts/material-icons.css"></head><body dir="ltr" data-md-color-primary="indigo" data-md-color-accent="indigo"><svg class="md-svg"><defs><svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg></defs></svg> <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off"> <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off"> <label class="md-overlay" data-md-component="overlay" for="__drawer"></label><a href="#build-script" tabindex="1" class="md-skip">Skip to content </a><header class="md-header" data-md-component="header"><nav class="md-header-nav md-grid"><div class="md-flex"><div class="md-flex__cell md-flex__cell--shrink"><a href="http://flubucore.dotnetcore.xyz" title="FlubuCore" class="md-header-nav__button md-logo"><img src="../assets/Svg/FlubuLogo.svg" width="24" height="24"></a></div><div class="md-flex__cell md-flex__cell--shrink"><label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label></div><div class="md-flex__cell md-flex__cell--stretch"><div class="md-flex__ellipsis md-header-nav__title" data-md-component="title"><span class="md-header-nav__topic">FlubuCore</span><span class="md-header-nav__topic">Build script fundamentals</span></div></div><div class="md-flex__cell md-flex__cell--shrink"><label class="md-icon md-icon--search md-header-nav__button" for="__search"></label><div class="md-search" data-md-component="search" role="dialog"><label class="md-search__overlay" for="__search"></label><div class="md-search__inner" role="search"><form class="md-search__form" name="search"><input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active"> <label class="md-icon md-search__icon" for="__search"></label> <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">&#xE5CD;</button></form><div class="md-search__output"><div class="md-search__scrollwrap" data-md-scrollfix><div class="md-search-result" data-md-component="result"><div class="md-search-result__meta">Type to start searching</div><ol class="md-search-result__list"></ol></div></div></div></div></div></div><div class="md-flex__cell md-flex__cell--shrink"><div class="md-header-nav__source"><a href="https://github.com/dotnetcore/FlubuCore/" title="Go to repository" class="md-source" data-md-source="github"><div class="md-source__icon"><svg viewBox="0 0 24 24" width="24" height="24"><use xlink:href="#__github" width="24" height="24"></use></svg></div><div class="md-source__repository">GitHub</div></a></div></div></div></nav></header><div class="md-container"><nav class="md-tabs" data-md-component="tabs"><div class="md-tabs__inner md-grid"><ul class="md-tabs__list"><li class="md-tabs__item"><a href=".." title="FlubuCore" class="md-tabs__link md-tabs__link--active">FlubuCore</a></li><li class="md-tabs__item"><a href="../WebApi/getting-started/" title="Web api" class="md-tabs__link">Web api</a></li><li class="md-tabs__item"><a href="../AwesomePlugins/awesome-plugins/" title="Awesome plugins" class="md-tabs__link">Awesome plugins</a></li><li class="md-tabs__item"><a href="https://github.com/dotnetcore/FlubuCore.Examples/wiki" title="Examples" class="md-tabs__link">Examples</a></li></ul></div></nav><main class="md-main"><div class="md-main__inner md-grid" data-md-component="container"><div class="md-sidebar md-sidebar--primary" data-md-component="navigation"><div class="md-sidebar__scrollwrap"><div class="md-sidebar__inner"><nav class="md-nav md-nav--primary" data-md-level="0"><label class="md-nav__title md-nav__title--site" for="__drawer"><a href="http://flubucore.dotnetcore.xyz" title="FlubuCore" class="md-nav__button md-logo"><img src="../assets/Svg/FlubuLogo.svg" width="48" height="48"></a>FlubuCore</label><div class="md-nav__source"><a href="https://github.com/dotnetcore/FlubuCore/" title="Go to repository" class="md-source" data-md-source="github"><div class="md-source__icon"><svg viewBox="0 0 24 24" width="24" height="24"><use xlink:href="#__github" width="24" height="24"></use></svg></div><div class="md-source__repository">GitHub</div></a></div><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href=".." title="FlubuCore" class="md-nav__link">FlubuCore</a></li><li class="md-nav__item"><a href="../getting-started/" title="Getting started" class="md-nav__link">Getting started</a></li><li class="md-nav__item md-nav__item--active"><input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc"><label class="md-nav__link md-nav__link--active" for="__toc">Build script fundamentals</label><a href="./" title="Build script fundamentals" class="md-nav__link md-nav__link--active">Build script fundamentals</a><nav class="md-nav md-nav--secondary"><label class="md-nav__title" for="__toc">Table of contents</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="#build-script" title="Build script" class="md-nav__link">Build script</a></li><li class="md-nav__item"><a href="#targets" title="Targets" class="md-nav__link">Targets</a><nav class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a href="#create-a-new-target" title="Create a new Target" class="md-nav__link">Create a new Target</a></li><li class="md-nav__item"><a href="#tasks" title="Tasks" class="md-nav__link">Tasks</a></li><li class="md-nav__item"><a href="#custom-code-tasks" title="Custom code / tasks" class="md-nav__link">Custom code / tasks</a></li><li class="md-nav__item"><a href="#target-dependencies" title="Target dependencies" class="md-nav__link">Target dependencies</a></li><li class="md-nav__item"><a href="#reuse-set-of-tasks-in-different-targets" title="Reuse set of tasks in different targets" class="md-nav__link">Reuse set of tasks in different targets</a></li><li class="md-nav__item"><a href="#group-tasks-and-apply-when-onerror-finally-on-them" title="Group tasks and apply When, OnError, Finally on them" class="md-nav__link">Group tasks and apply When, OnError, Finally on them</a></li><li class="md-nav__item"><a href="#async-execution-of-tasks-customcode-and-dependencies" title="Async execution of tasks, customCode and dependencies" class="md-nav__link">Async execution of tasks, customCode and dependencies</a></li><li class="md-nav__item"><a href="#other-features" title="Other features" class="md-nav__link">Other features</a><nav class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a href="#run-any-program-or-command-in-build-script-with-runprogramtask" title="Run any program or command in build script with RunProgramTask" class="md-nav__link">Run any program or command in build script with RunProgramTask</a></li></ul></nav></li><li class="md-nav__item"><a href="#build-properties" title="Build properties" class="md-nav__link">Build properties</a><nav class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a href="#predefined-build-properties" title="Predefined build properties" class="md-nav__link">Predefined build properties</a></li></ul></nav></li></ul></nav></li><li class="md-nav__item"><a href="#pass-command-line-arguments-settings-from-json-configuration-file-or-environment-variables-to-your-build-script-properties" title="Pass command line arguments, settings from json configuration file or environment variables to your build script properties." class="md-nav__link">Pass command line arguments, settings from json configuration file or environment variables to your build script properties.</a><nav class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a href="#passing-command-line-argument-to-build-script-property" title="Passing command line argument to build script property." class="md-nav__link">Passing command line argument to build script property.</a></li><li class="md-nav__item"><a href="#passing-setting-from-json-configuration-file-to-build-script-property" title="Passing setting from json configuration file to build script property" class="md-nav__link">Passing setting from json configuration file to build script property</a></li><li class="md-nav__item"><a href="#passing-enviroment-variable-to-build-script-property" title="Passing enviroment variable to build script property" class="md-nav__link">Passing enviroment variable to build script property</a></li></ul></nav></li><li class="md-nav__item"><a href="#pass-console-arguments-settings-from-json-configuration-file-environment-variables-with-formember-to-tasks" title="Pass console arguments, settings from json configuration file, environment variables with ForMember to tasks." class="md-nav__link">Pass console arguments, settings from json configuration file, environment variables with ForMember to tasks.</a></li><li class="md-nav__item"><a href="#referencing-external-assemblies-in-build-script" title="Referencing external assemblies in build script" class="md-nav__link">Referencing external assemblies in build script</a><nav class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a href="#by-assembly-relative-or-full-path" title="By assembly relative or full path" class="md-nav__link">By assembly relative or full path</a></li><li class="md-nav__item"><a href="#referencing-nuget-packages" title="Referencing nuget packages" class="md-nav__link">Referencing nuget packages</a></li><li class="md-nav__item"><a href="#load-assembly-by-assembly-full-name" title="Load assembly by assembly full name" class="md-nav__link">Load assembly by assembly full name</a></li><li class="md-nav__item"><a href="#load-all-assemblies-from-directory" title="Load all assemblies from directory" class="md-nav__link">Load all assemblies from directory</a></li></ul></nav></li><li class="md-nav__item"><a href="#adding-other-cs-files-to-script" title="Adding other .cs files to script" class="md-nav__link">Adding other .cs files to script</a></li><li class="md-nav__item"><a href="#build-system-providers" title="Build system providers" class="md-nav__link">Build system providers</a></li><li class="md-nav__item"><a href="#build-events" title="Build events" class="md-nav__link">Build events</a></li><li class="md-nav__item"><a href="#partial-and-base-class-in-script" title="Partial and base class in script" class="md-nav__link">Partial and base class in script</a></li></ul></nav></li><li class="md-nav__item"><a href="../build-script-runner/" title="Build script runner" class="md-nav__link">Build script runner</a></li><li class="md-nav__item"><a href="../tasks/" title="Tasks" class="md-nav__link">Tasks</a></li><li class="md-nav__item"><a href="../write-plugins/" title="How to write and use plugins" class="md-nav__link">How to write and use plugins</a></li><li class="md-nav__item"><a href="../Tests-debugging/" title="Tests and debuging" class="md-nav__link">Tests and debuging</a></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-8" type="checkbox" id="nav-8"><label class="md-nav__link" for="nav-8">Web api</label><nav class="md-nav" data-md-component="collapsible" data-md-level="1"><label class="md-nav__title" for="nav-8">Web api</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../WebApi/getting-started/" title="Getting started" class="md-nav__link">Getting started</a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-9" type="checkbox" id="nav-9"><label class="md-nav__link" for="nav-9">Awesome plugins</label><nav class="md-nav" data-md-component="collapsible" data-md-level="1"><label class="md-nav__title" for="nav-9">Awesome plugins</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../AwesomePlugins/awesome-plugins/" title="Plugins" class="md-nav__link">Plugins</a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-10" type="checkbox" id="nav-10"><label class="md-nav__link" for="nav-10">Examples</label><nav class="md-nav" data-md-component="collapsible" data-md-level="1"><label class="md-nav__title" for="nav-10">Examples</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="https://github.com/dotnetcore/FlubuCore.Examples/wiki" title="Index" class="md-nav__link">Index</a></li></ul></nav></li></ul></nav></div></div></div><div class="md-sidebar md-sidebar--secondary" data-md-component="toc"><div class="md-sidebar__scrollwrap"><div class="md-sidebar__inner"><nav class="md-nav md-nav--secondary"><label class="md-nav__title" for="__toc">Table of contents</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="#build-script" title="Build script" class="md-nav__link">Build script</a></li><li class="md-nav__item"><a href="#targets" title="Targets" class="md-nav__link">Targets</a><nav class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a href="#create-a-new-target" title="Create a new Target" class="md-nav__link">Create a new Target</a></li><li class="md-nav__item"><a href="#tasks" title="Tasks" class="md-nav__link">Tasks</a></li><li class="md-nav__item"><a href="#custom-code-tasks" title="Custom code / tasks" class="md-nav__link">Custom code / tasks</a></li><li class="md-nav__item"><a href="#target-dependencies" title="Target dependencies" class="md-nav__link">Target dependencies</a></li><li class="md-nav__item"><a href="#reuse-set-of-tasks-in-different-targets" title="Reuse set of tasks in different targets" class="md-nav__link">Reuse set of tasks in different targets</a></li><li class="md-nav__item"><a href="#group-tasks-and-apply-when-onerror-finally-on-them" title="Group tasks and apply When, OnError, Finally on them" class="md-nav__link">Group tasks and apply When, OnError, Finally on them</a></li><li class="md-nav__item"><a href="#async-execution-of-tasks-customcode-and-dependencies" title="Async execution of tasks, customCode and dependencies" class="md-nav__link">Async execution of tasks, customCode and dependencies</a></li><li class="md-nav__item"><a href="#other-features" title="Other features" class="md-nav__link">Other features</a><nav class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a href="#run-any-program-or-command-in-build-script-with-runprogramtask" title="Run any program or command in build script with RunProgramTask" class="md-nav__link">Run any program or command in build script with RunProgramTask</a></li></ul></nav></li><li class="md-nav__item"><a href="#build-properties" title="Build properties" class="md-nav__link">Build properties</a><nav class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a href="#predefined-build-properties" title="Predefined build properties" class="md-nav__link">Predefined build properties</a></li></ul></nav></li></ul></nav></li><li class="md-nav__item"><a href="#pass-command-line-arguments-settings-from-json-configuration-file-or-environment-variables-to-your-build-script-properties" title="Pass command line arguments, settings from json configuration file or environment variables to your build script properties." class="md-nav__link">Pass command line arguments, settings from json configuration file or environment variables to your build script properties.</a><nav class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a href="#passing-command-line-argument-to-build-script-property" title="Passing command line argument to build script property." class="md-nav__link">Passing command line argument to build script property.</a></li><li class="md-nav__item"><a href="#passing-setting-from-json-configuration-file-to-build-script-property" title="Passing setting from json configuration file to build script property" class="md-nav__link">Passing setting from json configuration file to build script property</a></li><li class="md-nav__item"><a href="#passing-enviroment-variable-to-build-script-property" title="Passing enviroment variable to build script property" class="md-nav__link">Passing enviroment variable to build script property</a></li></ul></nav></li><li class="md-nav__item"><a href="#pass-console-arguments-settings-from-json-configuration-file-environment-variables-with-formember-to-tasks" title="Pass console arguments, settings from json configuration file, environment variables with ForMember to tasks." class="md-nav__link">Pass console arguments, settings from json configuration file, environment variables with ForMember to tasks.</a></li><li class="md-nav__item"><a href="#referencing-external-assemblies-in-build-script" title="Referencing external assemblies in build script" class="md-nav__link">Referencing external assemblies in build script</a><nav class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a href="#by-assembly-relative-or-full-path" title="By assembly relative or full path" class="md-nav__link">By assembly relative or full path</a></li><li class="md-nav__item"><a href="#referencing-nuget-packages" title="Referencing nuget packages" class="md-nav__link">Referencing nuget packages</a></li><li class="md-nav__item"><a href="#load-assembly-by-assembly-full-name" title="Load assembly by assembly full name" class="md-nav__link">Load assembly by assembly full name</a></li><li class="md-nav__item"><a href="#load-all-assemblies-from-directory" title="Load all assemblies from directory" class="md-nav__link">Load all assemblies from directory</a></li></ul></nav></li><li class="md-nav__item"><a href="#adding-other-cs-files-to-script" title="Adding other .cs files to script" class="md-nav__link">Adding other .cs files to script</a></li><li class="md-nav__item"><a href="#build-system-providers" title="Build system providers" class="md-nav__link">Build system providers</a></li><li class="md-nav__item"><a href="#build-events" title="Build events" class="md-nav__link">Build events</a></li><li class="md-nav__item"><a href="#partial-and-base-class-in-script" title="Partial and base class in script" class="md-nav__link">Partial and base class in script</a></li></ul></nav></div></div></div><div class="md-content"><article class="md-content__inner md-typeset"><a href="https://github.com/dotnetcore/FlubuCore/edit/master/docs/buildscript-fundamentals.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a><h1>Build script fundamentals</h1><h2 id="build-script"><strong>Build script</strong><a class="headerlink" href="#build-script" title="Permanent link">&para;</a></h2>
<p>Each build script should inherit from DefaulBuildScript class. Two abstact methods from DefaultBuildScript have to be implemented.</p>
<ul>
<li>
<p>ConfigureTargets: Here you can create new targets that will perform specific work.</p>
</li>
<li>
<p>ConfigureBuildProperties: Here you can set various build properties which can be shared between multiple tasks and custom code.</p>
</li>
</ul>
<p>Empty build script example</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>    <span class="k">public</span> <span class="k">class</span> <span class="nc">BuildScript</span> <span class="p">:</span> <span class="n">DefaultBuildScript</span>
    <span class="p">{</span>
        <span class="k">protected</span> <span class="k">override</span> <span class="k">void</span> <span class="nf">ConfigureBuildProperties</span><span class="p">(</span><span class="n">IBuildPropertiesContext</span> <span class="n">context</span><span class="p">)</span>
        <span class="p">{</span>
        <span class="p">}</span>

        <span class="k">protected</span> <span class="k">override</span> <span class="k">void</span> <span class="nf">ConfigureTargets</span><span class="p">(</span><span class="n">ITaskContext</span> <span class="n">session</span><span class="p">)</span>
        <span class="p">{</span>
        <span class="p">}</span>
    <span class="p">}</span>
</pre></div>
</td></tr></table>

<p><a name="Targets"></a></p>
<h2 id="targets"><strong>Targets</strong><a class="headerlink" href="#targets" title="Permanent link">&para;</a></h2>
<hr />
<p>Targets are used to perform specific work in a specific order. A target can for example execute flubu built in tasks like a task for compiling the solution or it can execute some custom code. Target can also have dependencies on other targets.</p>
<h3 id="create-a-new-target"><strong>Create a new Target</strong><a class="headerlink" href="#create-a-new-target" title="Permanent link">&para;</a></h3>
<p>Following code will create a new target that will execute a built in task.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>    <span class="k">protected</span> <span class="k">override</span> <span class="k">void</span> <span class="nf">ConfigureTargets</span><span class="p">(</span><span class="n">ITaskContext</span> <span class="n">context</span><span class="p">)</span>
    <span class="p">{</span>
          <span class="n">context</span><span class="p">.</span><span class="n">CreateTarget</span><span class="p">(</span><span class="s">&quot;Compile&quot;</span><span class="p">)</span>
             <span class="p">.</span><span class="n">SetDescription</span><span class="p">(</span><span class="s">&quot;Compiles the solution&quot;</span><span class="p">)</span>
             <span class="p">.</span><span class="n">AddTask</span><span class="p">(</span><span class="n">x</span> <span class="p">=&gt;</span> <span class="n">x</span><span class="p">.</span><span class="n">CompileSolutionTask</span><span class="p">());</span>
    <span class="p">}</span>
</pre></div>
</td></tr></table>

<p>Target's can also be defined with attribute on method.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="na">    [Target(&quot;targetName&quot;, &quot;a&quot;, &quot;b&quot;)]</span>
<span class="na">    [Target(&quot;targetName2&quot;, &quot;c&quot;, &quot;d&quot;)]</span>
<span class="na">    [Target(&quot;targetName3&quot;, &quot;e&quot;, &quot;f&quot;)]</span>
    <span class="k">public</span> <span class="k">void</span> <span class="nf">Example</span><span class="p">(</span><span class="n">ITarget</span> <span class="n">target</span><span class="p">,</span> <span class="kt">string</span> <span class="n">source</span><span class="p">,</span> <span class="kt">string</span> <span class="n">destination</span><span class="p">)</span>
    <span class="p">{</span>
            <span class="n">target</span><span class="p">.</span><span class="n">AddTask</span><span class="p">(</span><span class="n">x</span> <span class="p">=&gt;</span> <span class="n">x</span><span class="p">.</span><span class="n">CopyFileTask</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">destination</span><span class="p">,</span> <span class="k">true</span><span class="p">));</span>
    <span class="p">}</span>
</pre></div>
</td></tr></table>

<p>You can also pass values to parameter through console arguments, FlubuCore config file.</p>
<p><code>Flubu targetName2 -destination=SomeOtherDestination</code></p>
<p><a name="Tasks"></a></p>
<h3 id="tasks"><strong>Tasks</strong><a class="headerlink" href="#tasks" title="Permanent link">&para;</a></h3>
<p>Tasks are divided in tasks and core tasks. tasks can be executed in .net and .net core projects. Core tasks can only be executed in .net core projects.</p>
<p>Following example executes 2 core tasks in a target. Order of execution is the same as specified in code.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>    <span class="n">context</span><span class="p">.</span><span class="n">CreateTarget</span><span class="p">(</span><span class="s">&quot;Build&quot;</span><span class="p">)</span>
        <span class="p">.</span><span class="n">AddCoreTask</span><span class="p">(</span><span class="n">x</span> <span class="p">=&gt;</span> <span class="n">x</span><span class="p">.</span><span class="n">Restore</span><span class="p">())</span>
        <span class="p">.</span><span class="n">AddCoreTask</span><span class="p">(</span><span class="n">x</span> <span class="p">=&gt;</span> <span class="n">x</span><span class="p">.</span><span class="n">Build</span><span class="p">());</span>
</pre></div>
</td></tr></table>

<p>All Tasks also have following methods</p>
<ul>
<li>
<p><code>.OnError((c, ex) =&gt; { c.LogInfo("Example");}))</code> - onError can perform some custom action when error occurs on single task</p>
</li>
<li>
<p><code>.Retry(5, 1000)</code> - Retry mechanism. You can apply specific condition when retry mechanism will retry task.</p>
</li>
<li>
<p><code>.Finally(c =&gt; { c.LogInfo("Example");}))</code> - Finally block acts just like finally in try catch</p>
</li>
<li>
<p><code>.DoNotFailOnError()</code> - script does not fail in case of exception. You can apply specific condition when task will not fail. </p>
</li>
<li>
<p><code>.NoLog()</code> - Task doesn't log anything to console output.</p>
</li>
<li>
<p><code>.SetDescription()</code> - Overrides the default help description of the task.</p>
</li>
<li>
<p><code>.ForMember()</code> - pass through console argument to method or property. See <a href="#Arguments-pass-through-to-tasks">Pass console arguments, settings from json configuration file, environment variables with ForMember to tasks.</a> for more details.</p>
</li>
<li>
<p>conditonal task execution with when cluase on single task (see bellow for group of tasks)</p>
</li>
</ul>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>       <span class="n">context</span><span class="p">.</span><span class="n">CreateTarget</span><span class="p">(</span><span class="s">&quot;Example&quot;</span><span class="p">)</span>
            <span class="p">.</span><span class="n">AddTask</span><span class="p">(</span><span class="n">x</span> <span class="p">=&gt;</span> <span class="n">x</span><span class="p">.</span><span class="n">CompileSolutionTask</span><span class="p">())</span>
            <span class="p">.</span><span class="n">AddTask</span><span class="p">(</span><span class="n">x</span> <span class="p">=&gt;</span> <span class="n">x</span><span class="p">.</span><span class="n">PublishNuGetPackageTask</span><span class="p">(</span><span class="s">&quot;packageId&quot;</span><span class="p">,</span> <span class="s">&quot;pathToNuspec&quot;</span><span class="p">))</span>
                <span class="p">.</span><span class="n">When</span><span class="p">(</span><span class="n">c</span> <span class="p">=&gt;</span> <span class="n">c</span><span class="p">.</span><span class="n">BuildSystems</span><span class="p">().</span><span class="n">Jenkins</span><span class="p">().</span><span class="n">IsRunningOnJenkins</span><span class="p">);</span>
</pre></div>
</td></tr></table>

<ul>
<li>set task parameters only when specified condition is meet.</li>
</ul>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="codehilite"><pre><span></span> <span class="kt">var</span> <span class="n">compile</span> <span class="p">=</span> <span class="n">context</span>
            <span class="p">.</span><span class="n">CreateTarget</span><span class="p">(</span><span class="s">&quot;compile&quot;</span><span class="p">)</span>
            <span class="p">.</span><span class="n">SetDescription</span><span class="p">(</span><span class="s">&quot;Compiles the VS solution&quot;</span><span class="p">)</span>
            <span class="p">.</span><span class="n">AddCoreTask</span><span class="p">(</span><span class="n">x</span> <span class="p">=&gt;</span> <span class="n">x</span><span class="p">.</span><span class="n">Build</span><span class="p">().</span><span class="n">Configuration</span><span class="p">(</span><span class="s">&quot;Release&quot;</span><span class="p">).</span><span class="n">When</span><span class="p">(</span>
                <span class="p">()</span> <span class="p">=&gt;</span>
            <span class="p">{</span>
                <span class="k">return</span> <span class="n">context</span><span class="p">.</span><span class="n">BuildSystems</span><span class="p">().</span><span class="n">IsLocalBuild</span><span class="p">;</span>

            <span class="p">},</span> <span class="n">task</span> <span class="p">=&gt;</span> <span class="p">{</span> <span class="n">task</span><span class="p">.</span><span class="n">Configuration</span><span class="p">(</span><span class="s">&quot;Debug&quot;</span><span class="p">);</span> <span class="p">}));</span>
</pre></div>
</td></tr></table>

<ul>
<li><code>.Interactive()</code> - Interactively pass argument from console to specified task method / parameter.</li>
</ul>
<p><a name="Custom-code"></a></p>
<h3 id="custom-code-tasks"><strong>Custom code / tasks</strong><a class="headerlink" href="#custom-code-tasks" title="Permanent link">&para;</a></h3>
<p>Following example executes some custom code. You can also use built in flubu tasks in custom code as shown in example.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>     <span class="k">protected</span> <span class="k">override</span> <span class="k">void</span> <span class="nf">ConfigureTargets</span><span class="p">(</span><span class="n">ITaskContext</span> <span class="n">context</span><span class="p">)</span>
     <span class="p">{</span>
         <span class="n">context</span><span class="p">.</span><span class="n">CreateTarget</span><span class="p">(</span><span class="s">&quot;Example&quot;</span><span class="p">)</span>
             <span class="p">.</span><span class="n">Do</span><span class="p">(</span><span class="n">CustomCodeExample</span><span class="p">);</span>
     <span class="p">}</span>

     <span class="k">private</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">CustomCodeExample</span><span class="p">(</span><span class="n">ITaskContext</span> <span class="n">context</span><span class="p">)</span>
     <span class="p">{</span>
         <span class="c1">//// You can put any c# code here and use any .net libraries.</span>
         <span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">&quot;Dummy custom code&quot;</span><span class="p">);</span>
         <span class="n">context</span><span class="p">.</span><span class="n">Tasks</span><span class="p">().</span><span class="n">NUnitTaskForNunitV3</span><span class="p">(</span><span class="s">&quot;project name&quot;</span><span class="p">).</span><span class="n">Execute</span><span class="p">(</span><span class="n">context</span><span class="p">);</span>
     <span class="p">}</span>
</pre></div>
</td></tr></table>

<p>You can also pass arguments to custom code like so:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>     <span class="k">protected</span> <span class="k">override</span> <span class="k">void</span> <span class="nf">ConfigureTargets</span><span class="p">(</span><span class="n">ITaskContext</span> <span class="n">context</span><span class="p">)</span>
     <span class="p">{</span>
         <span class="n">context</span><span class="p">.</span><span class="n">CreateTarget</span><span class="p">(</span><span class="s">&quot;Example&quot;</span><span class="p">)</span>
             <span class="p">.</span><span class="n">Do</span><span class="p">(</span><span class="n">CustomCodeExample</span><span class="p">,</span> <span class="s">&quot;some value&quot;</span><span class="p">,</span> <span class="m">1</span><span class="p">);</span>
     <span class="p">}</span>

     <span class="k">private</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">CustomCodeExample</span><span class="p">(</span><span class="n">ITaskContext</span> <span class="n">context</span><span class="p">,</span> <span class="kt">string</span> <span class="n">arg1</span><span class="p">,</span> <span class="kt">int</span> <span class="n">arg2</span><span class="p">)</span>
     <span class="p">{</span>
         <span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">&quot;Dummy custom code&quot;</span><span class="p">);</span>
         <span class="n">context</span><span class="p">.</span><span class="n">Tasks</span><span class="p">().</span><span class="n">NUnitTaskForNunitV3</span><span class="p">(</span><span class="s">&quot;project name&quot;</span><span class="p">).</span><span class="n">Execute</span><span class="p">(</span><span class="n">context</span><span class="p">);</span>
     <span class="p">}</span>
</pre></div>
</td></tr></table>

<p><a name="Target-dependencies"></a></p>
<h3 id="target-dependencies"><strong>Target dependencies</strong><a class="headerlink" href="#target-dependencies" title="Permanent link">&para;</a></h3>
<p>Target can have dependencies on other targets. All dependenies will be executed before target in the specified order.</p>
<p>When targetC is executed targetâ€™s will be executed in the following order: TargetB, TargetA, TargetC</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>      <span class="kt">var</span> <span class="n">targetA</span> <span class="p">=</span> <span class="n">context</span><span class="p">.</span><span class="n">CreateTarget</span><span class="p">(</span><span class="s">&quot;TargetA&quot;</span><span class="p">);</span>
      <span class="kt">var</span> <span class="n">targetB</span> <span class="p">=</span> <span class="n">context</span><span class="p">.</span><span class="n">CreateTarget</span><span class="p">(</span><span class="s">&quot;TargetB&quot;</span><span class="p">);</span>
      <span class="kt">var</span> <span class="n">targetC</span> <span class="p">=</span> <span class="n">context</span><span class="p">.</span><span class="n">CreateTarget</span><span class="p">(</span><span class="s">&quot;TargetC&quot;</span><span class="p">)</span>
          <span class="p">.</span><span class="n">DependsOn</span><span class="p">(</span><span class="n">targetB</span><span class="p">,</span> <span class="n">targetA</span><span class="p">);</span>
</pre></div>
</td></tr></table>

<p><a name="Reuse-set-of-tasks"></a></p>
<h3 id="reuse-set-of-tasks-in-different-targets"><strong>Reuse set of tasks in different targets</strong><a class="headerlink" href="#reuse-set-of-tasks-in-different-targets" title="Permanent link">&para;</a></h3>
<p>Following example shows how to reuse set of tasks in different targets:</p>
<p><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>    <span class="k">protected</span> <span class="k">override</span> <span class="k">void</span> <span class="nf">ConfigureTargets</span><span class="p">(</span><span class="n">ITaskContext</span> <span class="n">session</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">session</span><span class="p">.</span><span class="n">CreateTarget</span><span class="p">(</span><span class="s">&quot;deploy.local&quot;</span><span class="p">).</span><span class="n">AddTasks</span><span class="p">(</span><span class="n">Deploy</span><span class="p">,</span> <span class="s">&quot;c:\\ExamplaApp&quot;</span><span class="p">).</span><span class="n">SetAsDefault</span><span class="p">();</span>

        <span class="n">session</span><span class="p">.</span><span class="n">CreateTarget</span><span class="p">(</span><span class="s">&quot;deploy.test&quot;</span><span class="p">).</span><span class="n">AddTasks</span><span class="p">(</span><span class="n">Deploy</span><span class="p">,</span> <span class="s">&quot;d:\\ExamplaApp&quot;</span><span class="p">);</span>

        <span class="n">session</span><span class="p">.</span><span class="n">CreateTarget</span><span class="p">(</span><span class="s">&quot;deploy.prod&quot;</span><span class="p">).</span><span class="n">AddTasks</span><span class="p">(</span><span class="n">Deploy</span><span class="p">,</span> <span class="s">&quot;e:\\ExamplaApp&quot;</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">private</span> <span class="k">void</span> <span class="nf">Deploy</span><span class="p">(</span><span class="n">ITarget</span> <span class="n">target</span><span class="p">,</span> <span class="kt">string</span> <span class="n">deployPath</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">target</span>
            <span class="p">.</span><span class="n">AddTask</span><span class="p">(</span><span class="n">x</span> <span class="p">=&gt;</span> <span class="n">x</span><span class="p">.</span><span class="n">IisTasks</span><span class="p">().</span><span class="n">CreateAppPoolTask</span><span class="p">(</span><span class="s">&quot;Example app pool&quot;</span><span class="p">).</span><span class="n">Mode</span><span class="p">(</span><span class="n">CreateApplicationPoolMode</span><span class="p">.</span><span class="n">DoNothingIfExists</span><span class="p">))</span>
            <span class="p">.</span><span class="n">AddTask</span><span class="p">(</span><span class="n">x</span> <span class="p">=&gt;</span> <span class="n">x</span><span class="p">.</span><span class="n">IisTasks</span><span class="p">().</span><span class="n">ControlAppPoolTask</span><span class="p">(</span><span class="s">&quot;Example app pool&quot;</span><span class="p">,</span> <span class="n">ControlApplicationPoolAction</span><span class="p">.</span><span class="n">Stop</span><span class="p">).</span><span class="n">DoNotFailOnError</span><span class="p">())</span>
            <span class="p">.</span><span class="n">Do</span><span class="p">(</span><span class="n">UnzipPackage</span><span class="p">)</span>
            <span class="p">.</span><span class="n">AddTask</span><span class="p">(</span><span class="n">x</span> <span class="p">=&gt;</span> <span class="n">x</span><span class="p">.</span><span class="n">CopyDirectoryStructureTask</span><span class="p">(</span><span class="s">@&quot;Packages\ExampleApp&quot;</span><span class="p">,</span> <span class="s">@&quot;C:\ExampleApp&quot;</span><span class="p">,</span> <span class="k">true</span><span class="p">).</span><span class="n">Retry</span><span class="p">(</span><span class="m">20</span><span class="p">,</span> <span class="m">5000</span><span class="p">))</span>
            <span class="p">.</span><span class="n">Do</span><span class="p">(</span><span class="n">CreateWebSite</span><span class="p">)</span>
    <span class="p">}</span>
</pre></div>
</td></tr></table>
<a name="Group-task"></a></p>
<h3 id="group-tasks-and-apply-when-onerror-finally-on-them"><strong>Group tasks and apply When, OnError, Finally on them</strong><a class="headerlink" href="#group-tasks-and-apply-when-onerror-finally-on-them" title="Permanent link">&para;</a></h3>
<ul>
<li>Conditonal task execution with When clause on group of tasks.</li>
</ul>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>       <span class="k">protected</span> <span class="k">override</span> <span class="k">void</span> <span class="nf">ConfigureTargets</span><span class="p">(</span><span class="n">ITaskContext</span> <span class="n">context</span><span class="p">)</span>
       <span class="p">{</span>
             <span class="n">context</span><span class="p">.</span><span class="n">CreateTarget</span><span class="p">(</span><span class="s">&quot;Example&quot;</span><span class="p">)</span>
            <span class="p">.</span><span class="n">AddCoreTask</span><span class="p">(</span><span class="n">x</span> <span class="p">=&gt;</span> <span class="n">x</span><span class="p">.</span><span class="n">Build</span><span class="p">())</span>
            <span class="p">.</span><span class="n">Group</span><span class="p">(</span>
                <span class="n">target</span> <span class="p">=&gt;</span>
                <span class="p">{</span>
                    <span class="n">target</span><span class="p">.</span><span class="n">AddCoreTask</span><span class="p">(</span><span class="n">x</span> <span class="p">=&gt;</span> <span class="n">x</span><span class="p">.</span><span class="n">Pack</span><span class="p">());</span>
                    <span class="n">target</span><span class="p">.</span><span class="n">AddCoreTask</span><span class="p">(</span><span class="n">x</span> <span class="p">=&gt;</span> <span class="n">x</span><span class="p">.</span><span class="n">NugetPush</span><span class="p">(</span><span class="s">&quot;pathToPackage&quot;</span><span class="p">));</span>
                <span class="p">},</span>
                <span class="n">when</span><span class="p">:</span> <span class="n">c</span> <span class="p">=&gt;</span> <span class="p">!</span><span class="n">c</span><span class="p">.</span><span class="n">BuildSystems</span><span class="p">().</span><span class="n">Jenkins</span><span class="p">().</span><span class="n">IsRunningOnJenkins</span><span class="p">);</span>
        <span class="p">}</span>
</pre></div>
</td></tr></table>

<ul>
<li>Finally on group of tasks: onFinally acts just like finally in try/catch.</li>
</ul>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>        <span class="n">context</span><span class="p">.</span><span class="n">CreateTarget</span><span class="p">(</span><span class="s">&quot;Example&quot;</span><span class="p">)</span>
                <span class="p">.</span><span class="n">AddCoreTask</span><span class="p">(</span><span class="n">x</span> <span class="p">=&gt;</span> <span class="n">x</span><span class="p">.</span><span class="n">Build</span><span class="p">())</span>
                <span class="p">.</span><span class="n">Group</span><span class="p">(</span>
                    <span class="n">target</span> <span class="p">=&gt;</span>
                    <span class="p">{</span>
                        <span class="n">target</span><span class="p">.</span><span class="n">AddCoreTask</span><span class="p">(</span><span class="n">x</span> <span class="p">=&gt;</span> <span class="n">x</span><span class="p">.</span><span class="n">Pack</span><span class="p">());</span>
                        <span class="n">target</span><span class="p">.</span><span class="n">AddCoreTask</span><span class="p">(</span><span class="n">x</span> <span class="p">=&gt;</span> <span class="n">x</span><span class="p">.</span><span class="n">NugetPush</span><span class="p">(</span><span class="s">&quot;pathToPackage&quot;</span><span class="p">));</span>
                    <span class="p">},</span>
                    <span class="n">onFinally</span><span class="p">:</span> <span class="n">c</span> <span class="p">=&gt;</span>
                    <span class="p">{</span>
                        <span class="n">c</span><span class="p">.</span><span class="n">Tasks</span><span class="p">().</span><span class="n">DeleteFilesTask</span><span class="p">(</span><span class="s">&quot;pathToNupkg&quot;</span><span class="p">,</span> <span class="s">&quot;*.*&quot;</span><span class="p">,</span> <span class="k">true</span><span class="p">).</span><span class="n">Execute</span><span class="p">(</span><span class="n">c</span><span class="p">);</span>
                    <span class="p">});</span>
</pre></div>
</td></tr></table>

<ul>
<li>OnError on group of tasks:  You can perform some custom action when error occures in any of tasks that are in group.</li>
</ul>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>        <span class="n">context</span><span class="p">.</span><span class="n">CreateTarget</span><span class="p">(</span><span class="s">&quot;Example&quot;</span><span class="p">)</span>
            <span class="p">.</span><span class="n">AddCoreTask</span><span class="p">(</span><span class="n">x</span> <span class="p">=&gt;</span> <span class="n">x</span><span class="p">.</span><span class="n">Build</span><span class="p">())</span>
            <span class="p">.</span><span class="n">Group</span><span class="p">(</span>
                <span class="n">target</span> <span class="p">=&gt;</span>
                <span class="p">{</span>
                    <span class="n">target</span><span class="p">.</span><span class="n">AddCoreTask</span><span class="p">(</span><span class="n">x</span> <span class="p">=&gt;</span> <span class="n">x</span><span class="p">.</span><span class="n">Pack</span><span class="p">());</span>
                    <span class="n">target</span><span class="p">.</span><span class="n">AddCoreTask</span><span class="p">(</span><span class="n">x</span> <span class="p">=&gt;</span> <span class="n">x</span><span class="p">.</span><span class="n">NugetPush</span><span class="p">(</span><span class="s">&quot;pathToPackage&quot;</span><span class="p">));</span>
                <span class="p">},</span>
                <span class="n">onError</span><span class="p">:</span> <span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span> <span class="p">=&gt;</span>
                <span class="p">{</span>
                   <span class="c1">//// some custom action when error occures in any of the task in group.</span>
                <span class="p">});</span>
</pre></div>
</td></tr></table>

<p><a name="Async-execution"></a></p>
<h3 id="async-execution-of-tasks-customcode-and-dependencies"><strong>Async execution of tasks, customCode and dependencies</strong><a class="headerlink" href="#async-execution-of-tasks-customcode-and-dependencies" title="Permanent link">&para;</a></h3>
<ul>
<li>
Tasks can be executed asynchrounously with AddTaskAsync or AddCoreTaskAsync method.

</li>
<li>
Custom code can be executed asynchrounosly with DoAsync method.

</li>
<li>
Dependencies can be executed asynchrounosly with DependsOnAsync method.

</li>
</ul>

<p>Following target executes 3 tasks asynchorunusly.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>     <span class="n">session</span><span class="p">.</span><span class="n">CreateTarget</span><span class="p">(</span><span class="s">&quot;run.tests&quot;</span><span class="p">)</span>
         <span class="p">.</span><span class="n">AddTaskAsync</span><span class="p">(</span><span class="n">x</span> <span class="p">=&gt;</span> <span class="n">x</span><span class="p">.</span><span class="n">NUnitTaskForNunitV3</span><span class="p">(</span><span class="s">&quot;TestProjectName1&quot;</span><span class="p">))</span>
         <span class="p">.</span><span class="n">AddTaskAsync</span><span class="p">(</span><span class="n">x</span> <span class="p">=&gt;</span> <span class="n">x</span><span class="p">.</span><span class="n">NUnitTaskForNunitV3</span><span class="p">(</span><span class="s">&quot;TestProjectName1&quot;</span><span class="p">))</span>
         <span class="p">.</span><span class="n">AddTaskAsync</span><span class="p">(</span><span class="n">x</span> <span class="p">=&gt;</span> <span class="n">x</span><span class="p">.</span><span class="n">NUnitTaskForNunitV3</span><span class="p">(</span><span class="s">&quot;TestProjectName3&quot;</span><span class="p">));</span>
</pre></div>
</td></tr></table>

<p>Async and sync methods can also be mixed</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>     <span class="n">session</span><span class="p">.</span><span class="n">CreateTarget</span><span class="p">(</span><span class="s">&quot;async.example&quot;</span><span class="p">)</span>
         <span class="p">.</span><span class="n">AddTaskAsync</span><span class="p">(</span><span class="n">x</span> <span class="p">=&gt;</span> <span class="n">x</span><span class="p">.</span><span class="n">NUnitTaskForNunitV3</span><span class="p">(</span><span class="s">&quot;TestProjectName1&quot;</span><span class="p">))</span>
         <span class="p">.</span><span class="n">AddTaskAsync</span><span class="p">(</span><span class="n">x</span> <span class="p">=&gt;</span> <span class="n">x</span><span class="p">.</span><span class="n">NUnitTaskForNunitV3</span><span class="p">(</span><span class="s">&quot;TestProjectName1&quot;</span><span class="p">))</span>
         <span class="p">.</span><span class="n">Do</span><span class="p">(</span><span class="n">SomeCustomMethod</span><span class="p">)</span>
         <span class="p">.</span><span class="n">DoAsync</span><span class="p">(</span><span class="n">SomeCustomAsyncMethod2</span><span class="p">)</span>
         <span class="p">.</span><span class="n">DoAsync</span><span class="p">(</span><span class="n">SomeCustomAsyncMethod3</span><span class="p">);</span>
</pre></div>
</td></tr></table>

<p>The code above will first execute 2 nunit tasks asynchronously and wait for both tasks to finish. Then it will execute SomeCustomMethod synchrounosly. After it is finished code from SomeCustomAsyncMethod2 and SomeCustomAsyncMethod3 will be executed asynchronously.</p>
<p><a name="Other-features"></a></p>
<h3 id="other-features"><strong>Other features</strong><a class="headerlink" href="#other-features" title="Permanent link">&para;</a></h3>
<ul>
<li>SetAsDefault method: When applied to target that target is runned by default if no target is specified when running the script with runner.</li>
<li>SetAsHidden method: When applied to target that target is not shown in help and it can only be run as other target dependecie.</li>
<li>GetEnviromentVariable method: Get's the enviroment variable.</li>
<li>Must method: Condition in must will have to be meet otherwise target execution will fail before any task get executed.</li>
<li>Log:<code>.LogInfo("Some Text2", ConsoleColor.Blue);</code></li>
</ul>
<p><a name="Run-any-program"></a></p>
<h4 id="run-any-program-or-command-in-build-script-with-runprogramtask">Run any program or command in build script with RunProgramTask<a class="headerlink" href="#run-any-program-or-command-in-build-script-with-runprogramtask" title="Permanent link">&para;</a></h4>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>    <span class="k">protected</span> <span class="k">override</span> <span class="k">void</span> <span class="nf">ConfigureTargets</span><span class="p">(</span><span class="n">ITaskContext</span> <span class="n">session</span><span class="p">)</span>
    <span class="p">{</span>
         <span class="kt">var</span> <span class="n">runExternalProgramExample</span> <span class="p">=</span> <span class="n">session</span><span class="p">.</span><span class="n">CreateTarget</span><span class="p">(</span><span class="s">&quot;run.libz&quot;</span><span class="p">)</span>
            <span class="p">.</span><span class="n">AddTask</span><span class="p">(</span><span class="n">x</span> <span class="p">=&gt;</span> <span class="n">x</span><span class="p">.</span><span class="n">RunProgramTask</span><span class="p">(</span><span class="s">@&quot;packages\LibZ.Tool\1.2.0\tools\libz.exe&quot;</span><span class="p">)</span>
                <span class="p">.</span><span class="n">WorkingFolder</span><span class="p">(</span><span class="s">@&quot;.\src&quot;</span><span class="p">)</span>
                <span class="p">.</span><span class="n">WithArguments</span><span class="p">(</span><span class="s">&quot;add&quot;</span><span class="p">)</span>
                <span class="p">.</span><span class="n">WithArguments</span><span class="p">(</span><span class="s">&quot;--libz&quot;</span><span class="p">,</span> <span class="s">&quot;Assemblies.libz&quot;</span><span class="p">));</span>
    <span class="p">}</span>
</pre></div>
</td></tr></table>

<p>Linux Example:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>    <span class="k">protected</span> <span class="k">override</span> <span class="k">void</span> <span class="nf">ConfigureTargets</span><span class="p">(</span><span class="n">ITaskContext</span> <span class="n">session</span><span class="p">)</span>
    <span class="p">{</span>
         <span class="kt">var</span> <span class="n">runExternalProgramExample</span> <span class="p">=</span> <span class="n">session</span><span class="p">.</span><span class="n">CreateTarget</span><span class="p">(</span><span class="s">&quot;systemctl.example&quot;</span><span class="p">)</span>
            <span class="p">.</span><span class="n">AddTask</span><span class="p">(</span><span class="n">x</span> <span class="p">=&gt;</span> <span class="n">x</span><span class="p">.</span><span class="n">RunProgramTask</span><span class="p">(</span><span class="s">@&quot;systemctl&quot;</span><span class="p">)</span>             
                <span class="p">.</span><span class="n">WithArguments</span><span class="p">(</span><span class="s">&quot;start&quot;</span><span class="p">)</span>
                <span class="p">.</span><span class="n">WithArguments</span><span class="p">(</span><span class="s">&quot;nginx.service&quot;</span><span class="p">));</span>
    <span class="p">}</span>
</pre></div>
</td></tr></table>

<p><a name="Build-properties"></a></p>
<h3 id="build-properties"><strong>Build properties</strong><a class="headerlink" href="#build-properties" title="Permanent link">&para;</a></h3>
<p>You can define various build properties in ConfigureBuildProperties method to share them in different tasks and custom code.</p>
<p>Following example show how to share nunit console path across various nunit targets/tasks.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>        <span class="k">protected</span> <span class="k">override</span> <span class="k">void</span> <span class="nf">ConfigureBuildProperties</span><span class="p">(</span><span class="n">IBuildPropertiesContext</span> <span class="n">context</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">context</span><span class="p">.</span><span class="n">Properties</span><span class="p">.</span><span class="n">Set</span><span class="p">(</span><span class="n">BuildProps</span><span class="p">.</span><span class="n">NUnitConsolePath</span><span class="p">,</span> <span class="s">@&quot;packages\NUnit.ConsoleRunner.3.6.0\tools\nunit3-console.exe&quot;</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="k">protected</span> <span class="k">override</span> <span class="k">void</span> <span class="nf">ConfigureTargets</span><span class="p">(</span><span class="n">ITaskContext</span> <span class="n">session</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">session</span><span class="p">.</span><span class="n">CreateTarget</span><span class="p">(</span><span class="s">&quot;unit.tests1&quot;</span><span class="p">)</span>
                <span class="p">.</span><span class="n">SetDescription</span><span class="p">(</span><span class="s">&quot;Runs unit tests&quot;</span><span class="p">)</span>
                <span class="p">.</span><span class="n">AddTask</span><span class="p">(</span><span class="n">x</span> <span class="p">=&gt;</span> <span class="n">x</span><span class="p">.</span><span class="n">NUnitTaskForNunitV3</span><span class="p">(</span><span class="s">&quot;FlubuExample.Tests&quot;</span><span class="p">));</span>
            <span class="n">session</span><span class="p">.</span><span class="n">CreateTarget</span><span class="p">(</span><span class="s">&quot;unit.tests1&quot;</span><span class="p">)</span>
                <span class="p">.</span><span class="n">AddTask</span><span class="p">(</span><span class="n">x</span> <span class="p">=&gt;</span> <span class="n">x</span><span class="p">.</span><span class="n">NUnitTaskForNunitV3</span><span class="p">(</span><span class="s">&quot;FlubuExample.Tests2&quot;</span><span class="p">));</span>
        <span class="p">}</span>
</pre></div>
</td></tr></table>

<p>If nunit console path would not be set in build properties you would have to set it in each task separately.</p>
<p>like so:
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>       <span class="k">protected</span> <span class="k">override</span> <span class="k">void</span> <span class="nf">ConfigureTargets</span><span class="p">(</span><span class="n">ITaskContext</span> <span class="n">session</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">session</span><span class="p">.</span><span class="n">CreateTarget</span><span class="p">(</span><span class="s">&quot;unit.tests1&quot;</span><span class="p">)</span>
                <span class="p">.</span><span class="n">SetDescription</span><span class="p">(</span><span class="s">&quot;Runs unit tests&quot;</span><span class="p">)</span>
                <span class="p">.</span><span class="n">AddTask</span><span class="p">(</span><span class="n">x</span> <span class="p">=&gt;</span> <span class="n">x</span><span class="p">.</span><span class="n">NUnitTaskForNunitV3</span><span class="p">(</span><span class="s">&quot;FlubuExample.Tests&quot;</span><span class="p">)</span>
                  <span class="p">.</span><span class="n">NunitConsolePath</span><span class="p">(</span><span class="s">@&quot;packages\NUnit.ConsoleRunner.3.6.0\tools\nunit3-console.exe&quot;</span><span class="p">));</span>
            <span class="n">session</span><span class="p">.</span><span class="n">CreateTarget</span><span class="p">(</span><span class="s">&quot;unit.tests1&quot;</span><span class="p">)</span>
                <span class="p">.</span><span class="n">AddTask</span><span class="p">(</span><span class="n">x</span> <span class="p">=&gt;</span> <span class="n">x</span><span class="p">.</span><span class="n">NUnitTaskForNunitV3</span><span class="p">(</span><span class="s">&quot;FlubuExample.Tests2&quot;</span><span class="p">).</span>
                   <span class="n">NunitConsolePath</span><span class="p">(</span><span class="s">@&quot;packages\NUnit.ConsoleRunner.3.6.0\tools\nunit3-console.exe&quot;</span><span class="p">));</span>
        <span class="p">}</span>
</pre></div>
</td></tr></table></p>
<p><a name="Predefined-build-properties"></a></p>
<h4 id="predefined-build-properties">Predefined build properties<a class="headerlink" href="#predefined-build-properties" title="Permanent link">&para;</a></h4>
<p>Some build properties are already defined. You can access them through interface:</p>
<p><code>context.Properties.Get(PredefinedBuildProperties.OsPlatform);</code></p>
<p>Available predefined build properties:</p>
<ul>
<li>OsPlatform</li>
<li>PathToDotnetExecutable</li>
<li>UserProfileFolder</li>
<li>OutputDir </li>
<li>ProductRootDir</li>
</ul>
<p>All of them can be overriden.</p>
<p><a name="Script-arguments"></a></p>
<h2 id="pass-command-line-arguments-settings-from-json-configuration-file-or-environment-variables-to-your-build-script-properties"><strong>Pass command line arguments, settings from json configuration file or environment variables to your build script properties.</strong><a class="headerlink" href="#pass-command-line-arguments-settings-from-json-configuration-file-or-environment-variables-to-your-build-script-properties" title="Permanent link">&para;</a></h2>
<p>You can pass command line arguments, settings from json configuration file or environment variables to your build script properties by adding FromArg attribute to property. </p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>      <span class="k">public</span> <span class="k">class</span> <span class="nc">SimpleScript</span> <span class="p">:</span> <span class="n">DefaultBuildScript</span>
      <span class="p">{</span>
<span class="na">        [FromArg(&quot;sn&quot;, &quot;If true app is deployed on second node. Otherwise not.&quot;)]</span>
        <span class="k">public</span> <span class="kt">bool</span> <span class="n">deployOnSecondNode</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>        

        <span class="k">protected</span> <span class="k">override</span> <span class="k">void</span> <span class="nf">ConfigureTargets</span><span class="p">(</span><span class="n">ITaskContext</span> <span class="n">context</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">context</span><span class="p">.</span><span class="n">CreateTarget</span><span class="p">(</span><span class="s">&quot;Deploy.Exapmle&quot;</span><span class="p">)</span>
                <span class="p">.</span><span class="n">AddTask</span><span class="p">(</span><span class="n">x</span> <span class="p">=&gt;</span> <span class="n">x</span><span class="p">.</span><span class="n">FlubuWebApiTasks</span><span class="p">().</span><span class="n">GetTokenTask</span><span class="p">(</span><span class="s">&quot;user&quot;</span><span class="p">,</span> <span class="s">&quot;pass&quot;</span><span class="p">).</span><span class="n">SetWebApiBaseUrl</span><span class="p">(</span><span class="s">&quot;noade1Url&quot;</span><span class="p">))</span>
                <span class="p">.</span><span class="n">AddTask</span><span class="p">(</span><span class="n">x</span> <span class="p">=&gt;</span> <span class="n">x</span><span class="p">.</span><span class="n">FlubuWebApiTasks</span><span class="p">().</span><span class="n">UploadPackageTask</span><span class="p">(</span><span class="s">&quot;packageDir&quot;</span><span class="p">,</span> <span class="s">&quot;*.zip&quot;</span><span class="p">))</span>
                <span class="p">.</span><span class="n">AddTask</span><span class="p">(</span><span class="n">x</span> <span class="p">=&gt;</span> <span class="n">x</span><span class="p">.</span><span class="n">FlubuWebApiTasks</span><span class="p">().</span><span class="n">ExecuteScriptTask</span><span class="p">(</span><span class="s">&quot;Deploy&quot;</span><span class="p">,</span> <span class="s">&quot;DeployScript.cs&quot;</span><span class="p">))</span>
                <span class="p">.</span><span class="n">Group</span><span class="p">(</span><span class="n">target</span> <span class="p">=&gt;</span>
                    <span class="p">{</span>
                    <span class="n">target</span><span class="p">.</span><span class="n">AddTask</span><span class="p">(</span><span class="n">x</span> <span class="p">=&gt;</span> <span class="n">x</span><span class="p">.</span><span class="n">FlubuWebApiTasks</span><span class="p">().</span><span class="n">GetTokenTask</span><span class="p">(</span><span class="s">&quot;user&quot;</span><span class="p">,</span> <span class="s">&quot;pass&quot;</span><span class="p">).</span><span class="n">SetWebApiBaseUrl</span><span class="p">(</span><span class="s">&quot;noade2Url&quot;</span><span class="p">))</span>
                               <span class="p">.</span><span class="n">AddTask</span><span class="p">(</span><span class="n">x</span> <span class="p">=&gt;</span> <span class="n">x</span><span class="p">.</span><span class="n">FlubuWebApiTasks</span><span class="p">().</span><span class="n">UploadPackageTask</span><span class="p">(</span><span class="s">&quot;packageDir&quot;</span><span class="p">,</span> <span class="s">&quot;*.zip&quot;</span><span class="p">))</span>
                               <span class="p">.</span><span class="n">AddTask</span><span class="p">(</span><span class="n">x</span> <span class="p">=&gt;</span> <span class="n">x</span><span class="p">.</span><span class="n">FlubuWebApiTasks</span><span class="p">().</span><span class="n">ExecuteScriptTask</span><span class="p">(</span><span class="s">&quot;Deploy&quot;</span><span class="p">,</span> <span class="s">&quot;DeployScript.cs&quot;</span><span class="p">));</span>
                     <span class="p">},</span>
                     <span class="n">when</span><span class="p">:</span> <span class="n">c</span> <span class="p">=&gt;</span> <span class="n">deployOnSecondNode</span><span class="p">);</span>         
        <span class="p">}</span>
      <span class="p">}</span>
</pre></div>
</td></tr></table>

<p>First parameter in FromArg attribute is the argument key. Second is the help description of the property shown in flubu runner. You actually don't need to put attribute on property. If u dont then the key is the same as property name and help is not shown for property in build script runner.</p>
<p>Property types that are supported: string, boolean, int, long, decimal, double, DateTime.</p>
<p><a name="Command-line-argument"></a></p>
<h3 id="passing-command-line-argument-to-build-script-property"><strong>Passing command line argument to build script property.</strong><a class="headerlink" href="#passing-command-line-argument-to-build-script-property" title="Permanent link">&para;</a></h3>
<p><code>Dotnet flubu Deploy.Example -sn=true</code></p>
<p><a name="json-configuration-file"></a></p>
<h3 id="passing-setting-from-json-configuration-file-to-build-script-property"><strong>Passing setting from json configuration file to build script property</strong><a class="headerlink" href="#passing-setting-from-json-configuration-file-to-build-script-property" title="Permanent link">&para;</a></h3>
<ul>
<li>Create file FlubuSettings.json where Flubu runner is located.</li>
<li>Add argument key and value to file in json format.</li>
<li>For above example json file would look like this:</li>
</ul>
<p><code>{
      "sn" : "true",
      "SomeOtherKey" : "SomeOtherValue"
    }</code> </p>
<ul>
<li>It's typical to have different configuration settings for different environments, for example, development, testing, and production. Just create different files FlubuSettings.{Enviroment}.Json and <a href="https://andrewlock.net/how-to-set-the-hosting-environment-in-asp-net-core/">set enviroment variable</a> 'ASPNETCORE_ENVIRONMENT' on desired machine </li>
<li>You can also create json configuration file by machine name FlubuSettings.{MachineName}.Json. If MachineName in file matches the machine name Flubu will automatically read settings from that file.</li>
</ul>
<p><a name="enviroment-variable"></a></p>
<h3 id="passing-enviroment-variable-to-build-script-property"><strong>Passing enviroment variable to build script property</strong><a class="headerlink" href="#passing-enviroment-variable-to-build-script-property" title="Permanent link">&para;</a></h3>
<p>You can also set script arguments through environment variables. environment variables must have prefix flubu_</p>
<p>For above example you would add environment variable from windows command line with the following command:</p>
<p><code>set flubu_sn=true</code></p>
<p><a name="Arguments-pass-through-to-tasks"></a></p>
<h2 id="pass-console-arguments-settings-from-json-configuration-file-environment-variables-with-formember-to-tasks"><strong>Pass console arguments, settings from json configuration file, environment variables with ForMember to tasks.</strong><a class="headerlink" href="#pass-console-arguments-settings-from-json-configuration-file-environment-variables-with-formember-to-tasks" title="Permanent link">&para;</a></h2>
<p>There is an alternative more sophisticated way to pass console arguments, settings and environment variables to tasks</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>    <span class="k">protected</span> <span class="k">override</span> <span class="k">void</span> <span class="nf">ConfigureTargets</span><span class="p">(</span><span class="n">ITaskContext</span> <span class="n">context</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">context</span><span class="p">.</span><span class="n">CreateTarget</span><span class="p">(</span><span class="s">&quot;compile&quot;</span><span class="p">)</span>
            <span class="p">.</span><span class="n">AddTask</span><span class="p">(</span><span class="n">x</span> <span class="p">=&gt;</span> <span class="n">x</span><span class="p">.</span><span class="n">CompileSolutionTask</span><span class="p">()</span>
                <span class="p">.</span><span class="n">ForMember</span><span class="p">(</span><span class="n">y</span> <span class="p">=&gt;</span> <span class="n">y</span><span class="p">.</span><span class="n">SolutionFileName</span><span class="p">(</span><span class="s">&quot;someSolution.sln&quot;</span><span class="p">),</span> <span class="s">&quot;solution&quot;</span><span class="p">,</span> <span class="s">&quot;The solution to build.&quot;</span><span class="p">));</span>
    <span class="p">}</span>
</pre></div>
</td></tr></table>

<ul>
<li>First parameter is the method or property argument will be passed through. values set in method parameters are default values if argument is not specified when running the build script.</li>
<li>Second parameter is the argument key.</li>
<li>Third optional parameter is help that it will be displayed in detailed target help. If parameter is not set then default generated help will be displayed.</li>
</ul>
<p><code>Dotnet flubu compile -solution=someothersolution.sln</code></p>
<p><a name="Referencing-other-assemblies-in-build-script"></a></p>
<h2 id="referencing-external-assemblies-in-build-script"><strong>Referencing external assemblies in build script</strong><a class="headerlink" href="#referencing-external-assemblies-in-build-script" title="Permanent link">&para;</a></h2>
<p>FlubuCore loads all assemblies references and nuget packages automatically from build script csproj. Csproj must be at on of the location specified <a href="https://github.com/flubu-core/flubu.core/blob/master/FlubuCore/Scripting/Analysis/ProjectFileAnalyzer.cs">here</a> If not assembly and nuget references will not be loaded automatically when executing script.</p>
<p>Note: You can also disable referencing assemblies and nuget packages from build script by adding attribute to build script.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="na">[DisableLoadScriptReferencesAutomatically]</span>
<span class="k">public</span> <span class="k">class</span> <span class="nc">BuildScript</span> <span class="p">:</span> <span class="n">DefaultBuildScript</span>
<span class="p">{</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>

<p>Alternatively when you are running scripts without csproj(for example deploy scripts) external references can be added  with directives in three ways:</p>
<p><a name="By-assembly-relative-or-full-path"></a></p>
<h3 id="by-assembly-relative-or-full-path"><strong>By assembly relative or full path</strong><a class="headerlink" href="#by-assembly-relative-or-full-path" title="Permanent link">&para;</a></h3>
<p>On the build script class you have to add attribute:</p>
<p><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="na">    [Assembly(@&quot;.\packages\Newtonsoft.Json.9.0.1\lib\net45\Newtonsoft.Json.dll&quot;)]</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">BuildScript</span> <span class="p">:</span> <span class="n">DefaultBuildScript</span>
    <span class="p">{</span>
       <span class="k">public</span> <span class="k">void</span> <span class="nf">ReferencedAssemlby</span><span class="p">(</span><span class="n">ITaskContext</span> <span class="n">context</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">JsonConvert</span><span class="p">.</span><span class="n">SerializeObject</span><span class="p">(</span><span class="s">&quot;Example&quot;</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
</pre></div>
</td></tr></table>
FlubuCore can also load all assemblies from specified directory and optionaly from it's subdirectories</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="na">[AssemblyFromDirectory(@&quot;.\Packages&quot;, true)]</span>
<span class="k">public</span> <span class="k">class</span> <span class="nc">BuildScript</span> <span class="p">:</span> <span class="n">DefaultBuildScript</span>
<span class="p">{</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>

<p><a name="Referencing-nuget-packages"></a></p>
<h3 id="referencing-nuget-packages"><strong>Referencing nuget packages</strong><a class="headerlink" href="#referencing-nuget-packages" title="Permanent link">&para;</a></h3>
<p>Flubu supports referencing nuget packages. .net core sdk or msbuild must be installed if u want to reference nuget packages otherwise they will not get restored.</p>
<p>You have to add NugetPackage attribute on the script class:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="na">    [NugetPackage(&quot;Newtonsoftjson&quot;, &quot;11.0.2&quot;)]</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">BuildScript</span> <span class="p">:</span> <span class="n">DefaultBuildScript</span>
    <span class="p">{</span>
       <span class="k">public</span> <span class="k">void</span> <span class="nf">ReferencedNugetPackage</span><span class="p">(</span><span class="n">ITaskContext</span> <span class="n">context</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">JsonConvert</span><span class="p">.</span><span class="n">SerializeObject</span><span class="p">(</span><span class="s">&quot;Example&quot;</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
</pre></div>
</td></tr></table>

<p><a name="Load-assembly-by-assembly-full-name"></a></p>
<h3 id="load-assembly-by-assembly-full-name"><strong>Load assembly by assembly full name</strong><a class="headerlink" href="#load-assembly-by-assembly-full-name" title="Permanent link">&para;</a></h3>
<p>System assemblies can be loaded by fully qualifed assemlby name.</p>
<p>You have to add Reference attribute on the script class:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="na">    [Reference(&quot;System.Xml.XmlDocument, System.Xml, Version=4.0.0.0, Culture=neutral, publicKeyToken=b77a5c561934e089&quot;)]</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">BuildScript</span> <span class="p">:</span> <span class="n">DefaultBuildScript</span>
    <span class="p">{</span>
       <span class="k">public</span> <span class="k">void</span> <span class="nf">ReferencedAssemlby</span><span class="p">(</span><span class="n">ITaskContext</span> <span class="n">context</span><span class="p">)</span>
       <span class="p">{</span>
            <span class="n">XmlDocument</span> <span class="n">xml</span> <span class="p">=</span> <span class="k">new</span> <span class="n">XmlDocument</span><span class="p">();</span>
       <span class="p">}</span>
    <span class="p">}</span>
</pre></div>
</td></tr></table>

<p>One way to get fully qualifed assembly name:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>var fullQualifedAssemblyName = typeof(XmlDocument).Assembly.FullName;
</pre></div>
</td></tr></table>

<p><a name="Load-all-assemblies-from-directory"></a></p>
<h3 id="load-all-assemblies-from-directory"><strong>Load all assemblies from directory</strong><a class="headerlink" href="#load-all-assemblies-from-directory" title="Permanent link">&para;</a></h3>
<p>Even if you are not using your script together with csproj flubu can load all external assemblies for you automatically from directory (assemblies in subdirectories are also loaded ). </p>
<p>By default flubu loads all assemblies from directory FlubuLib. Just create the directory at the flubu runner location and put assemblies in that directory. You can specify directory in flubu runner from where to load assemblyes also:</p>
<p><code>flubu.exe -ass=somedirectory</code></p>
<p><code>dotnet flubu -ass=somedirectory</code>
alternatively you can put ass key into flubusettings.json file:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>`{
  &quot;ass&quot; : &quot;someDirectory&quot;,
  &quot;SomeOtherKey&quot; : &quot;SomeOtherValue&quot;
}`
</pre></div>
</td></tr></table>

<p><a name="Adding-other-cs-files-to-build-script"></a></p>
<h2 id="adding-other-cs-files-to-script"><strong>Adding other .cs files to script</strong><a class="headerlink" href="#adding-other-cs-files-to-script" title="Permanent link">&para;</a></h2>
<p>On the build script class you have to add attribute:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="na">    [Include(@&quot;.\BuildHelper.cs&quot;)]</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">BuildScript</span> <span class="p">:</span> <span class="n">DefaultBuildScript</span>
    <span class="p">{</span>
       <span class="k">public</span> <span class="k">void</span> <span class="nf">Example</span><span class="p">(</span><span class="n">ITaskContext</span> <span class="n">context</span><span class="p">)</span>
       <span class="p">{</span>
            <span class="n">BuildHelper</span><span class="p">.</span><span class="n">SomeMethod</span><span class="p">();</span>
       <span class="p">}</span>
    <span class="p">}</span>    
</pre></div>
</td></tr></table>

<p>FlubuCore can also load all .cs files to script from specified directory and optionaly from it's subfolders.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="na">[IncludeFromDirectory(@&quot;.\Helpers&quot;, true)]</span>
<span class="k">public</span> <span class="k">class</span> <span class="nc">BuildScript</span> <span class="p">:</span> <span class="n">DefaultBuildScript</span>
<span class="p">{</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>

<p><a name="Build-system-providers"></a></p>
<h2 id="build-system-providers"><strong>Build system providers</strong><a class="headerlink" href="#build-system-providers" title="Permanent link">&para;</a></h2>
<p>You can acces various build, commit... information for various build systems (such as Jenkins, TeamCity, AppVeyor, Travis...) </p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>      <span class="k">protected</span> <span class="k">override</span> <span class="k">void</span> <span class="nf">ConfigureTargets</span><span class="p">(</span><span class="n">ITaskContext</span> <span class="n">context</span><span class="p">)</span>
      <span class="p">{</span>
            <span class="kt">bool</span> <span class="n">isLocalBuild</span> <span class="p">=</span> <span class="n">context</span><span class="p">.</span><span class="n">BuildSystems</span><span class="p">().</span><span class="n">IsLocalBuild</span><span class="p">;</span>
            <span class="kt">var</span> <span class="n">gitCommitId</span> <span class="p">=</span> <span class="n">context</span><span class="p">.</span><span class="n">BuildSystems</span><span class="p">().</span><span class="n">Jenkins</span><span class="p">().</span><span class="n">GitCommitId</span><span class="p">;</span>
      <span class="p">}</span>
</pre></div>
</td></tr></table>

<p><a name="Before-After"></a></p>
<h2 id="build-events"><strong>Build events</strong><a class="headerlink" href="#build-events" title="Permanent link">&para;</a></h2>
<ul>
<li>
<p>OnBuildFailed event:
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="k">public</span> <span class="k">class</span> <span class="nc">BuildScript</span> <span class="p">:</span> <span class="n">DefaultBuildScript</span>
<span class="p">{</span>
    <span class="k">protected</span> <span class="k">override</span> <span class="k">void</span> <span class="nf">OnBuildFailed</span><span class="p">(</span><span class="n">ITaskSession</span> <span class="n">session</span><span class="p">,</span> <span class="n">Exception</span> <span class="n">ex</span><span class="p">)</span>
    <span class="p">{</span>
    <span class="p">}</span> 
<span class="p">}</span>
</pre></div>
</td></tr></table></p>
</li>
<li>
<p>before and after target execution events:
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>    <span class="k">protected</span> <span class="k">override</span> <span class="k">void</span> <span class="nf">BeforeTargetExecution</span><span class="p">(</span><span class="n">ITaskContext</span> <span class="n">context</span><span class="p">)</span>
    <span class="p">{</span>
    <span class="p">}</span>

    <span class="k">protected</span> <span class="k">override</span> <span class="k">void</span> <span class="nf">AfterTargetExecution</span><span class="p">(</span><span class="n">ITaskContext</span> <span class="n">context</span><span class="p">)</span>
    <span class="p">{</span>
    <span class="p">}</span>
</pre></div>
</td></tr></table></p>
</li>
<li>
<p>before and after build execution events:
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>    <span class="k">protected</span> <span class="k">override</span> <span class="k">void</span> <span class="nf">BeforeBuildExecution</span><span class="p">(</span><span class="n">ITaskContext</span> <span class="n">context</span><span class="p">)</span>
    <span class="p">{</span>
    <span class="p">}</span>

    <span class="k">protected</span> <span class="k">override</span> <span class="k">void</span> <span class="nf">AfterBuildExecution</span><span class="p">(</span><span class="n">ITaskSession</span> <span class="n">session</span><span class="p">)</span>
    <span class="p">{</span>
    <span class="p">}</span>
</pre></div>
</td></tr></table>
<a name="partial-class"></a></p>
</li>
</ul>
<h2 id="partial-and-base-class-in-script"><strong>Partial and base class in script</strong><a class="headerlink" href="#partial-and-base-class-in-script" title="Permanent link">&para;</a></h2>
<p>Partial and base classes are loaded automatically if they are located in the same directory as buildscript. Otherwise they have to be added with Include attribute. </p></article></div></div></main><footer class="md-footer"><div class="md-footer-nav"><nav class="md-footer-nav__inner md-grid"><a href="../getting-started/" title="Getting started" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev"><div class="md-flex__cell md-flex__cell--shrink"><i class="md-icon md-icon--arrow-back md-footer-nav__button"></i></div><div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span class="md-flex__ellipsis"><span class="md-footer-nav__direction">Previous</span>Getting started</span></div></a><a href="../build-script-runner/" title="Build script runner" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next"><div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span class="md-flex__ellipsis"><span class="md-footer-nav__direction">Next</span>Build script runner</span></div><div class="md-flex__cell md-flex__cell--shrink"><i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i></div></a></nav></div><div class="md-footer-meta md-typeset"><div class="md-footer-meta__inner md-grid"><div class="md-footer-copyright">powered by <a href="https://www.mkdocs.org">MkDocs</a> and <a href="https://squidfunk.github.io/mkdocs-material/">Material for MkDocs</a></div></div></div></footer></div><script src="../assets/javascripts/application.b260a35d.js"></script><script>app.initialize({version:"1.0.4",url:{base:".."}})</script></body></html>